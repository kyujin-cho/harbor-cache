import{c as r,a as e,o,d as O,j as P,f as w,g as d,b as x,m as j,n as M,e as b,t as u,F as V,s as S,w as W,h as $,v as A,A as G,B as U}from"./index-CQZJkS29.js";import{r as N}from"./ArrowPathIcon-DlvPnKNn.js";import{r as H,a as I}from"./PlusIcon-C0hu2H4I.js";import{r as J}from"./TrashIcon-BHqW53U8.js";function K(B,h){return o(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})])}const Q={class:"p-8"},X={class:"mb-8 flex items-center justify-between"},Y={class:"flex gap-2"},Z=["disabled"],ee={key:0,class:"mb-6 rounded-md bg-red-50 p-4"},te={class:"text-sm text-red-700"},se={key:1,class:"mb-6 rounded-md bg-green-50 p-4"},ae={class:"text-sm text-green-700"},le={key:2,class:"flex items-center justify-center h-64"},ne={key:3,class:"card p-0 overflow-hidden"},re={class:"min-w-full divide-y divide-gray-200"},oe={class:"bg-white divide-y divide-gray-200"},ie={class:"px-6 py-4 whitespace-nowrap"},de={class:"font-medium text-gray-900"},ue={class:"px-6 py-4 whitespace-nowrap"},ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ve={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},pe=["onClick"],me=["onClick"],fe={key:0},ye={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},xe={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},be={class:"flex items-center justify-between mb-4"},ge={class:"text-lg font-semibold text-gray-900"},we=["disabled"],he={class:"label"},_e=["required"],ke=["value"],Ce={class:"flex justify-end gap-3 pt-4"},Ue=["disabled"],De={key:5,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Me={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},$e={class:"text-gray-600 mb-6"},je={class:"flex justify-end gap-3"},Ve=["disabled"],Re=O({__name:"UsersView",setup(B){const h=d([]),g=d(!0),v=d(!1),p=d(""),m=d(""),_=d(!1),c=d("create"),f=d(null),k=d(!1),y=d(null),l=d({username:"",password:"",role:"read-only"}),R=[{value:"admin",label:"Admin"},{value:"read-write",label:"Read/Write"},{value:"read-only",label:"Read Only"}];async function C(){var a,t,i,s;g.value=!0,p.value="";try{const n=await U.list();h.value=n.data}catch(n){p.value=((s=(i=(t=(a=n.response)==null?void 0:a.data)==null?void 0:t.errors)==null?void 0:i[0])==null?void 0:s.message)||"Failed to fetch users"}finally{g.value=!1}}function q(){c.value="create",f.value=null,l.value={username:"",password:"",role:"read-only"},_.value=!0}function z(a){c.value="edit",f.value=a,l.value={username:a.username,password:"",role:a.role},_.value=!0}function D(){_.value=!1,f.value=null,l.value={username:"",password:"",role:"read-only"}}async function E(){var a,t,i,s;v.value=!0,p.value="",m.value="";try{if(c.value==="create")await U.create(l.value),m.value=`User "${l.value.username}" created successfully`;else if(f.value){const n={};l.value.role!==f.value.role&&(n.role=l.value.role),l.value.password&&(n.password=l.value.password),await U.update(f.value.id,n),m.value=`User "${f.value.username}" updated successfully`}D(),await C()}catch(n){p.value=((s=(i=(t=(a=n.response)==null?void 0:a.data)==null?void 0:t.errors)==null?void 0:i[0])==null?void 0:s.message)||"Operation failed"}finally{v.value=!1}}function F(a){y.value=a,k.value=!0}async function L(){var a,t,i,s;if(y.value){v.value=!0,p.value="",m.value="";try{await U.delete(y.value.id),m.value=`User "${y.value.username}" deleted successfully`,k.value=!1,y.value=null,await C()}catch(n){p.value=((s=(i=(t=(a=n.response)==null?void 0:a.data)==null?void 0:t.errors)==null?void 0:i[0])==null?void 0:s.message)||"Delete failed"}finally{v.value=!1}}}function T(a){return new Date(a).toLocaleDateString()}return P(C),(a,t)=>{var i;return o(),r("div",Q,[e("div",X,[t[6]||(t[6]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"User Management"),e("p",{class:"mt-1 text-sm text-gray-500"},"Manage user accounts and permissions")],-1)),e("div",Y,[e("button",{onClick:C,disabled:g.value,class:"btn btn-secondary flex items-center gap-2"},[x(b(N),{class:M(["h-4 w-4",{"animate-spin":g.value}])},null,8,["class"]),t[4]||(t[4]=j(" Refresh ",-1))],8,Z),e("button",{onClick:q,class:"btn btn-primary flex items-center gap-2"},[x(b(H),{class:"h-4 w-4"}),t[5]||(t[5]=j(" Add User ",-1))])])]),p.value?(o(),r("div",ee,[e("p",te,u(p.value),1)])):w("",!0),m.value?(o(),r("div",se,[e("p",ae,u(m.value),1)])):w("",!0),g.value?(o(),r("div",le,[x(b(N),{class:"h-8 w-8 text-gray-400 animate-spin"})])):(o(),r("div",ne,[e("table",re,[t[8]||(t[8]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Username "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Role "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Created "),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",oe,[(o(!0),r(V,null,S(h.value,s=>(o(),r("tr",{key:s.id},[e("td",ie,[e("span",de,u(s.username),1)]),e("td",ue,[e("span",{class:M(["px-2 py-1 text-xs font-medium rounded-full",{"bg-purple-100 text-purple-800":s.role==="admin","bg-blue-100 text-blue-800":s.role==="read-write","bg-gray-100 text-gray-800":s.role==="read-only"}])},u(s.role),3)]),e("td",ce,u(T(s.created_at)),1),e("td",ve,[e("button",{onClick:n=>z(s),class:"text-primary-600 hover:text-primary-900 mr-3"},[x(b(I),{class:"h-4 w-4"})],8,pe),e("button",{onClick:n=>F(s),class:"text-red-600 hover:text-red-900"},[x(b(J),{class:"h-4 w-4"})],8,me)])]))),128)),h.value.length===0?(o(),r("tr",fe,[...t[7]||(t[7]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," No users found ",-1)])])):w("",!0)])])])),_.value?(o(),r("div",ye,[e("div",xe,[e("div",be,[e("h3",ge,u(c.value==="create"?"Create User":"Edit User"),1),e("button",{onClick:D,class:"text-gray-400 hover:text-gray-600"},[x(b(K),{class:"h-5 w-5"})])]),e("form",{onSubmit:W(E,["prevent"]),class:"space-y-4"},[e("div",null,[t[9]||(t[9]=e("label",{class:"label"},"Username",-1)),$(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.username=s),type:"text",required:"",disabled:c.value==="edit",class:M(["input",{"bg-gray-100":c.value==="edit"}])},null,10,we),[[A,l.value.username]])]),e("div",null,[e("label",he,u(c.value==="create"?"Password":"New Password (leave empty to keep current)"),1),$(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.password=s),type:"password",required:c.value==="create",class:"input"},null,8,_e),[[A,l.value.password]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"label"},"Role",-1)),$(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.role=s),class:"input"},[(o(),r(V,null,S(R,s=>e("option",{key:s.value,value:s.value},u(s.label),9,ke)),64))],512),[[G,l.value.role]])]),e("div",Ce,[e("button",{type:"button",onClick:D,class:"btn btn-secondary"}," Cancel "),e("button",{type:"submit",disabled:v.value,class:"btn btn-primary"},u(v.value?"Saving...":c.value==="create"?"Create":"Save"),9,Ue)])],32)])])):w("",!0),k.value?(o(),r("div",De,[e("div",Me,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Delete User?",-1)),e("p",$e,' Are you sure you want to delete user "'+u((i=y.value)==null?void 0:i.username)+'"? This action cannot be undone. ',1),e("div",je,[e("button",{onClick:t[3]||(t[3]=s=>{k.value=!1,y.value=null}),class:"btn btn-secondary"}," Cancel "),e("button",{onClick:L,disabled:v.value,class:"btn btn-danger"},u(v.value?"Deleting...":"Delete"),9,Ve)])])])):w("",!0)])}}});export{Re as default};
