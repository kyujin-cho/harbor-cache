import{c as l,a as t,o as a,d as E,j as q,k as J,f as C,n as _,g,l as R,m as v,e as c,t as n,b as d,F as M,r as S,p as A,q as O,s as V,x as D,y as G}from"./index-LlC-mSnx.js";import{r as T}from"./ArrowPathIcon-CuEPsUyF.js";import{r as K}from"./ClockIcon-DSqtPU-8.js";function z(h,s){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"})])}function Q(h,s){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"})])}function W(h,s){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])}function X(h,s){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"})])}function Y(h,s){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"})])}function tt(h,s){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.429 9.75 2.25 12l4.179 2.25m0-4.5 5.571 3 5.571-3m-11.142 0L2.25 7.5 12 2.25l9.75 5.25-4.179 2.25m0 0L21.75 12l-4.179 2.25m0 0 4.179 2.25L12 21.75 2.25 16.5l4.179-2.25m11.142 0-5.571 3-5.571-3"})])}const et={class:"p-8"},st={class:"mb-8 flex items-center justify-between"},ot={class:"flex items-center gap-3"},at=["disabled"],nt={key:0,class:"mb-4 flex items-center gap-2 text-sm text-primary-600"},lt={key:1,class:"mb-6 rounded-md bg-red-50 p-4"},rt={class:"text-sm text-red-700"},it={key:2,class:"flex items-center justify-center h-64"},ct={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},dt={class:"stat-card"},ut={class:"flex items-center gap-3"},gt={class:"p-2 bg-blue-100 rounded-lg"},vt={class:"stat-value"},ht={class:"stat-card"},xt={class:"flex items-center gap-3"},pt={class:"p-2 bg-green-100 rounded-lg"},_t={class:"stat-value"},ft={class:"stat-card"},mt={class:"flex items-center gap-3"},yt={class:"p-2 bg-purple-100 rounded-lg"},wt={class:"stat-value"},bt={class:"stat-card"},kt={class:"flex items-center gap-3"},Ct={class:"p-2 bg-orange-100 rounded-lg"},Mt={class:"stat-value"},At={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},jt={class:"card"},Bt={class:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2"},$t={class:"grid grid-cols-3 gap-6"},Rt={class:"text-center"},St={class:"relative inline-flex items-center justify-center"},Vt={class:"w-20 h-20 transform -rotate-90"},Dt=["stroke-dasharray"],Tt={class:"text-center"},zt={class:"text-3xl font-bold text-green-600"},Lt={class:"text-center"},Ft={class:"text-3xl font-bold text-red-600"},Nt={class:"card"},Ht={class:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2"},It={class:"space-y-4"},Ut={class:"flex justify-between text-sm mb-1"},Zt={class:"font-medium text-gray-900"},Pt={class:"w-full bg-gray-200 rounded-full h-3"},Et={class:"grid grid-cols-2 gap-4 pt-4"},qt={class:"bg-purple-50 rounded-lg p-3"},Jt={class:"text-xl font-bold text-purple-700"},Ot={class:"bg-blue-50 rounded-lg p-3"},Gt={class:"text-xl font-bold text-blue-700"},Kt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Qt={class:"card"},Wt={class:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2"},Xt={key:0,class:"space-y-3"},Yt={class:"flex-1 min-w-0"},te={class:"text-sm font-medium text-gray-900 truncate"},ee={class:"text-xs text-gray-500 font-mono truncate"},se={class:"text-right"},oe={class:"text-sm font-bold text-gray-900"},ae={key:1,class:"text-center text-gray-500 py-8"},ne={class:"card"},le={class:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2"},re={key:0,class:"space-y-3"},ie={class:"flex-1 min-w-0"},ce={class:"text-sm text-gray-900"},de={class:"font-medium"},ue={class:"font-mono text-xs"},ge={class:"text-xs text-gray-500"},ve={key:1,class:"text-center text-gray-500 py-8"},_e=E({__name:"DashboardView",setup(h){const s=g(null),m=g([]),y=g([]),x=g(!0),f=g(""),u=g(!1),j=g(30);let p=null;async function L(){var o,e,r,i;try{const k=await D.getStats();s.value=k.data}catch(k){f.value=((i=(r=(e=(o=k.response)==null?void 0:o.data)==null?void 0:e.errors)==null?void 0:r[0])==null?void 0:i.message)||"Failed to fetch stats"}}async function F(){try{const o=await D.getTopAccessed();m.value=o.data}catch(o){console.error("Failed to fetch top accessed:",o)}}async function N(){try{const o=await G.list({limit:5});y.value=o.data.logs}catch(o){console.error("Failed to fetch recent logs:",o)}}async function w(){x.value=!0,f.value="",await Promise.all([L(),F(),N()]),x.value=!1}function H(){u.value=!u.value,u.value?I():B()}function I(){p&&clearInterval(p),p=setInterval(()=>{x.value||w()},j.value*1e3)}function B(){p&&(clearInterval(p),p=null)}const U=A(()=>s.value?(s.value.hit_rate*100).toFixed(1):"0.0"),$=A(()=>{if(!s.value)return"text-gray-600";const o=s.value.hit_rate*100;return o>=80?"text-green-600":o>=50?"text-yellow-600":"text-red-600"}),b=A(()=>{if(!s.value)return 0;const o=10*1024*1024*1024;return Math.min(100,s.value.total_size/o*100)});function Z(o){const e=new Date(o),i=new Date().getTime()-e.getTime();return i<6e4?"Just now":i<36e5?`${Math.floor(i/6e4)} min ago`:i<864e5?`${Math.floor(i/36e5)} hours ago`:e.toLocaleDateString()}function P(o){return o.length>20?o.substring(0,20)+"...":o}return q(w),J(()=>{B()}),(o,e)=>(a(),l("div",et,[t("div",st,[e[1]||(e[1]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900"},"Dashboard"),t("p",{class:"mt-1 text-sm text-gray-500"},"Overview of your Harbor Cache instance")],-1)),t("div",ot,[t("button",{onClick:H,class:_(["btn flex items-center gap-2",u.value?"btn-primary":"btn-secondary"])},[u.value?(a(),R(c(X),{key:1,class:"h-4 w-4"})):(a(),R(c(Y),{key:0,class:"h-4 w-4"})),v(" "+n(u.value?"Stop":"Auto")+" Refresh ",1)],2),t("button",{onClick:w,disabled:x.value,class:"btn btn-secondary flex items-center gap-2"},[d(c(T),{class:_(["h-4 w-4",{"animate-spin":x.value}])},null,8,["class"]),e[0]||(e[0]=v(" Refresh ",-1))],8,at)])]),u.value?(a(),l("div",nt,[e[2]||(e[2]=t("div",{class:"h-2 w-2 bg-primary-500 rounded-full animate-pulse"},null,-1)),v(" Auto-refreshing every "+n(j.value)+" seconds ",1)])):C("",!0),f.value?(a(),l("div",lt,[t("p",rt,n(f.value),1)])):C("",!0),x.value&&!s.value?(a(),l("div",it,[d(c(T),{class:"h-8 w-8 text-gray-400 animate-spin"})])):s.value?(a(),l(M,{key:3},[t("div",ct,[t("div",dt,[t("div",ut,[t("div",gt,[d(c(S),{class:"h-6 w-6 text-blue-600"})]),t("div",null,[e[3]||(e[3]=t("p",{class:"stat-label"},"Total Size",-1)),t("p",vt,n(s.value.total_size_human),1)])])]),t("div",ht,[t("div",xt,[t("div",pt,[d(c(tt),{class:"h-6 w-6 text-green-600"})]),t("div",null,[e[4]||(e[4]=t("p",{class:"stat-label"},"Total Entries",-1)),t("p",_t,n(s.value.entry_count),1)])])]),t("div",ft,[t("div",mt,[t("div",yt,[d(c(W),{class:"h-6 w-6 text-purple-600"})]),t("div",null,[e[5]||(e[5]=t("p",{class:"stat-label"},"Manifests",-1)),t("p",wt,n(s.value.manifest_count),1)])])]),t("div",bt,[t("div",kt,[t("div",Ct,[d(c(S),{class:"h-6 w-6 text-orange-600"})]),t("div",null,[e[6]||(e[6]=t("p",{class:"stat-label"},"Blobs",-1)),t("p",Mt,n(s.value.blob_count),1)])])])]),t("div",At,[t("div",jt,[t("h2",Bt,[d(c(z),{class:"h-5 w-5 text-gray-500"}),e[7]||(e[7]=v(" Cache Performance ",-1))]),t("div",$t,[t("div",Rt,[t("div",St,[(a(),l("svg",Vt,[e[8]||(e[8]=t("circle",{cx:"40",cy:"40",r:"35",stroke:"currentColor","stroke-width":"6",fill:"none",class:"text-gray-200"},null,-1)),t("circle",{cx:"40",cy:"40",r:"35",stroke:"currentColor","stroke-width":"6",fill:"none",class:_($.value),"stroke-dasharray":`${s.value.hit_rate*220} 220`},null,10,Dt)])),t("span",{class:_(["absolute text-lg font-bold",$.value])},n(U.value)+"% ",3)]),e[9]||(e[9]=t("p",{class:"text-sm text-gray-500 mt-2"},"Hit Rate",-1))]),t("div",Tt,[t("p",zt,n(s.value.hit_count),1),e[10]||(e[10]=t("p",{class:"text-sm text-gray-500"},"Cache Hits",-1))]),t("div",Lt,[t("p",Ft,n(s.value.miss_count),1),e[11]||(e[11]=t("p",{class:"text-sm text-gray-500"},"Cache Misses",-1))])])]),t("div",Nt,[t("h2",Ht,[d(c(Q),{class:"h-5 w-5 text-gray-500"}),e[12]||(e[12]=v(" Storage Usage ",-1))]),t("div",It,[t("div",null,[t("div",Ut,[e[13]||(e[13]=t("span",{class:"text-gray-600"},"Used Space",-1)),t("span",Zt,n(s.value.total_size_human),1)]),t("div",Pt,[t("div",{class:_(["h-3 rounded-full transition-all duration-500",b.value>80?"bg-red-500":b.value>50?"bg-yellow-500":"bg-green-500"]),style:O({width:`${b.value}%`})},null,6)])]),t("div",Et,[t("div",qt,[e[14]||(e[14]=t("p",{class:"text-sm text-purple-600"},"Manifests",-1)),t("p",Jt,n(s.value.manifest_count),1)]),t("div",Ot,[e[15]||(e[15]=t("p",{class:"text-sm text-blue-600"},"Blobs",-1)),t("p",Gt,n(s.value.blob_count),1)])])])])]),t("div",Kt,[t("div",Qt,[t("h2",Wt,[d(c(z),{class:"h-5 w-5 text-gray-500"}),e[16]||(e[16]=v(" Most Accessed Items ",-1))]),m.value.length>0?(a(),l("div",Xt,[(a(!0),l(M,null,V(m.value.slice(0,5),(r,i)=>(a(),l("div",{key:r.id,class:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50"},[t("div",{class:_(["w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold",i===0?"bg-yellow-100 text-yellow-700":i===1?"bg-gray-200 text-gray-600":i===2?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-500"])},n(i+1),3),t("div",Yt,[t("p",te,n(r.repository||"Unknown"),1),t("p",ee,n(P(r.digest)),1)]),t("div",se,[t("p",oe,n(r.access_count),1),e[17]||(e[17]=t("p",{class:"text-xs text-gray-500"},"accesses",-1))])]))),128))])):(a(),l("div",ae," No cached items yet "))]),t("div",ne,[t("h2",le,[d(c(K),{class:"h-5 w-5 text-gray-500"}),e[18]||(e[18]=v(" Recent Activity ",-1))]),y.value.length>0?(a(),l("div",re,[(a(!0),l(M,null,V(y.value,r=>(a(),l("div",{key:r.id,class:"flex items-start gap-3 p-2 rounded-lg hover:bg-gray-50"},[e[20]||(e[20]=t("div",{class:"w-2 h-2 rounded-full bg-primary-500 mt-2 flex-shrink-0"},null,-1)),t("div",ie,[t("p",ce,[t("span",de,n(r.action),1),e[19]||(e[19]=t("span",{class:"text-gray-500"}," on ",-1)),t("span",ue,n(r.resource_type),1)]),t("p",ge,n(r.username||"System")+" - "+n(Z(r.timestamp)),1)])]))),128))])):(a(),l("div",ve," No recent activity "))])])],64)):C("",!0)]))}});export{_e as default};
