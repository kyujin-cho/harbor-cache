import{d as K,j as T,c as o,a as e,f as _,g as c,b as u,l as k,n as V,e as p,t as x,F as E,p as N,x as C,h as D,v as $,o as i}from"./index-oxDBCDlh.js";import{r as j}from"./ArrowPathIcon-ZfxELW0L.js";import{r as M,a as q}from"./XMarkIcon-Cp_LQpx1.js";import{r as S}from"./TrashIcon-weaO9PdU.js";const R={class:"p-8"},G={class:"mb-8 flex items-center justify-between"},H={class:"flex gap-2"},I=["disabled"],J={key:0,class:"mb-6 rounded-md bg-red-50 p-4"},O={class:"text-sm text-red-700"},P={key:1,class:"mb-6 rounded-md bg-green-50 p-4"},Q={class:"text-sm text-green-700"},W={key:2,class:"flex items-center justify-center h-64"},X={key:3,class:"card p-0 overflow-hidden"},Y={class:"min-w-full divide-y divide-gray-200"},Z={class:"bg-white divide-y divide-gray-200"},ee={class:"px-6 py-4 whitespace-nowrap"},te={class:"text-sm font-mono text-gray-900 bg-gray-100 px-2 py-1 rounded"},se={class:"px-6 py-4"},ae={class:"text-sm text-gray-700"},le={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ne={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},oe=["onClick"],ie={key:0},re={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},de={class:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-auto"},ce={class:"flex items-center justify-between mb-4"},ue={class:"space-y-3"},pe={class:"flex-1"},ve=["onUpdate:modelValue","disabled"],fe={class:"flex-1"},me=["onUpdate:modelValue"],xe=["onClick"],ye={class:"flex justify-end gap-3 pt-6 mt-6 border-t"},ge=["disabled"],Ce=K({__name:"ConfigView",setup(he){const g=c([]),y=c(!0),v=c(!1),r=c(""),f=c(""),b=c(!1),m=c([]);async function h(){var a,t,s,n;y.value=!0,r.value="";try{const l=await C.list();g.value=l.data}catch(l){r.value=((n=(s=(t=(a=l.response)==null?void 0:a.data)==null?void 0:t.errors)==null?void 0:s[0])==null?void 0:n.message)||"Failed to fetch config"}finally{y.value=!1}}function U(){m.value=g.value.map(a=>({key:a.key,value:a.value})),b.value=!0}function w(){b.value=!1,m.value=[]}function A(){m.value.push({key:"",value:"",isNew:!0})}function B(a){m.value.splice(a,1)}async function F(){var t,s,n,l;const a=m.value.filter(d=>d.key.trim()&&d.value.trim());if(a.length===0){r.value="At least one valid config entry is required";return}v.value=!0,r.value="",f.value="";try{await C.update({entries:a.map(d=>({key:d.key.trim(),value:d.value.trim()}))}),f.value="Configuration saved successfully",w(),await h()}catch(d){r.value=((l=(n=(s=(t=d.response)==null?void 0:t.data)==null?void 0:s.errors)==null?void 0:n[0])==null?void 0:l.message)||"Save failed"}finally{v.value=!1}}async function L(a){var t,s,n,l;if(confirm(`Delete config key "${a}"?`)){v.value=!0,r.value="",f.value="";try{await C.delete(a),f.value=`Config key "${a}" deleted`,await h()}catch(d){r.value=((l=(n=(s=(t=d.response)==null?void 0:t.data)==null?void 0:s.errors)==null?void 0:n[0])==null?void 0:l.message)||"Delete failed"}finally{v.value=!1}}}function z(a){return new Date(a).toLocaleString()}return T(h),(a,t)=>(i(),o("div",R,[e("div",G,[t[2]||(t[2]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Configuration"),e("p",{class:"mt-1 text-sm text-gray-500"},"Manage runtime configuration settings")],-1)),e("div",H,[e("button",{onClick:h,disabled:y.value,class:"btn btn-secondary flex items-center gap-2"},[u(p(j),{class:V(["h-4 w-4",{"animate-spin":y.value}])},null,8,["class"]),t[0]||(t[0]=k(" Refresh ",-1))],8,I),e("button",{onClick:U,class:"btn btn-primary flex items-center gap-2"},[u(p(M),{class:"h-4 w-4"}),t[1]||(t[1]=k(" Edit Config ",-1))])])]),r.value?(i(),o("div",J,[e("p",O,x(r.value),1)])):_("",!0),f.value?(i(),o("div",P,[e("p",Q,x(f.value),1)])):_("",!0),y.value?(i(),o("div",W,[u(p(j),{class:"h-8 w-8 text-gray-400 animate-spin"})])):(i(),o("div",X,[e("table",Y,[t[4]||(t[4]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Key "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Value "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Updated "),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",Z,[(i(!0),o(E,null,N(g.value,s=>(i(),o("tr",{key:s.key},[e("td",ee,[e("code",te,x(s.key),1)]),e("td",se,[e("span",ae,x(s.value),1)]),e("td",le,x(z(s.updated_at)),1),e("td",ne,[e("button",{onClick:n=>L(s.key),class:"text-red-600 hover:text-red-900"},[u(p(S),{class:"h-4 w-4"})],8,oe)])]))),128)),g.value.length===0?(i(),o("tr",ie,[...t[3]||(t[3]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"},' No configuration entries found. Click "Edit Config" to add some. ',-1)])])):_("",!0)])])])),b.value?(i(),o("div",re,[e("div",de,[e("div",ce,[t[5]||(t[5]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Edit Configuration",-1)),e("button",{onClick:w,class:"text-gray-400 hover:text-gray-600"},[u(p(q),{class:"h-5 w-5"})])]),e("div",ue,[(i(!0),o(E,null,N(m.value,(s,n)=>(i(),o("div",{key:n,class:"flex gap-3 items-start"},[e("div",pe,[D(e("input",{"onUpdate:modelValue":l=>s.key=l,type:"text",placeholder:"Key",class:V(["input font-mono text-sm",{"bg-gray-100":!s.isNew}]),disabled:!s.isNew},null,10,ve),[[$,s.key]])]),e("div",fe,[D(e("input",{"onUpdate:modelValue":l=>s.value=l,type:"text",placeholder:"Value",class:"input text-sm"},null,8,me),[[$,s.value]])]),e("button",{onClick:l=>B(n),class:"p-2 text-red-600 hover:text-red-900"},[u(p(S),{class:"h-5 w-5"})],8,xe)]))),128)),e("button",{onClick:A,class:"flex items-center gap-2 text-sm text-primary-600 hover:text-primary-700"},[u(p(M),{class:"h-4 w-4"}),t[6]||(t[6]=k(" Add Entry ",-1))])]),e("div",ye,[e("button",{onClick:w,class:"btn btn-secondary"}," Cancel "),e("button",{onClick:F,disabled:v.value,class:"btn btn-primary"},x(v.value?"Saving...":"Save Changes"),9,ge)])])])):_("",!0)]))}});export{Ce as default};
