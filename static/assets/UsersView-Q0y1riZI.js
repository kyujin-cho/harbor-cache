import{c as n,a as e,o,d as O,j as P,f as h,g as d,b as g,m as V,n as j,e as b,t as u,F as B,s as S,w as W,h as $,v as A,A as Z,B as U}from"./index-DhrKuHkq.js";import{r as L}from"./ArrowPathIcon-D7kk2pJo.js";import{r as G}from"./TrashIcon-Bnz-hOoG.js";function H(M,y){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})])}function I(M,y){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}function J(M,y){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})])}const K={class:"p-8"},Q={class:"mb-8 flex items-center justify-between"},X={class:"flex gap-2"},Y=["disabled"],ee={key:0,class:"mb-6 rounded-md bg-red-50 p-4"},te={class:"text-sm text-red-700"},se={key:1,class:"mb-6 rounded-md bg-green-50 p-4"},ae={class:"text-sm text-green-700"},le={key:2,class:"flex items-center justify-center h-64"},ne={key:3,class:"card p-0 overflow-hidden"},oe={class:"min-w-full divide-y divide-gray-200"},re={class:"bg-white divide-y divide-gray-200"},ie={class:"px-6 py-4 whitespace-nowrap"},de={class:"font-medium text-gray-900"},ue={class:"px-6 py-4 whitespace-nowrap"},ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ve={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},pe=["onClick"],me=["onClick"],fe={key:0},xe={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ye={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},ge={class:"flex items-center justify-between mb-4"},be={class:"text-lg font-semibold text-gray-900"},we=["disabled"],he={class:"label"},_e=["required"],ke=["value"],Ce={class:"flex justify-end gap-3 pt-4"},Ue=["disabled"],Me={key:5,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},De={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},je={class:"text-gray-600 mb-6"},$e={class:"flex justify-end gap-3"},Ve=["disabled"],Le=O({__name:"UsersView",setup(M){const y=d([]),w=d(!0),v=d(!1),p=d(""),m=d(""),_=d(!1),c=d("create"),f=d(null),k=d(!1),x=d(null),l=d({username:"",password:"",role:"read-only"}),N=[{value:"admin",label:"Admin"},{value:"read-write",label:"Read/Write"},{value:"read-only",label:"Read Only"}];async function C(){var a,t,i,s;w.value=!0,p.value="";try{const r=await U.list();y.value=r.data}catch(r){p.value=((s=(i=(t=(a=r.response)==null?void 0:a.data)==null?void 0:t.errors)==null?void 0:i[0])==null?void 0:s.message)||"Failed to fetch users"}finally{w.value=!1}}function R(){c.value="create",f.value=null,l.value={username:"",password:"",role:"read-only"},_.value=!0}function q(a){c.value="edit",f.value=a,l.value={username:a.username,password:"",role:a.role},_.value=!0}function D(){_.value=!1,f.value=null,l.value={username:"",password:"",role:"read-only"}}async function z(){var a,t,i,s;v.value=!0,p.value="",m.value="";try{if(c.value==="create")await U.create(l.value),m.value=`User "${l.value.username}" created successfully`;else if(f.value){const r={};l.value.role!==f.value.role&&(r.role=l.value.role),l.value.password&&(r.password=l.value.password),await U.update(f.value.id,r),m.value=`User "${f.value.username}" updated successfully`}D(),await C()}catch(r){p.value=((s=(i=(t=(a=r.response)==null?void 0:a.data)==null?void 0:t.errors)==null?void 0:i[0])==null?void 0:s.message)||"Operation failed"}finally{v.value=!1}}function E(a){x.value=a,k.value=!0}async function F(){var a,t,i,s;if(x.value){v.value=!0,p.value="",m.value="";try{await U.delete(x.value.id),m.value=`User "${x.value.username}" deleted successfully`,k.value=!1,x.value=null,await C()}catch(r){p.value=((s=(i=(t=(a=r.response)==null?void 0:a.data)==null?void 0:t.errors)==null?void 0:i[0])==null?void 0:s.message)||"Delete failed"}finally{v.value=!1}}}function T(a){return new Date(a).toLocaleDateString()}return P(C),(a,t)=>{var i;return o(),n("div",K,[e("div",Q,[t[6]||(t[6]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"User Management"),e("p",{class:"mt-1 text-sm text-gray-500"},"Manage user accounts and permissions")],-1)),e("div",X,[e("button",{onClick:C,disabled:w.value,class:"btn btn-secondary flex items-center gap-2"},[g(b(L),{class:j(["h-4 w-4",{"animate-spin":w.value}])},null,8,["class"]),t[4]||(t[4]=V(" Refresh ",-1))],8,Y),e("button",{onClick:R,class:"btn btn-primary flex items-center gap-2"},[g(b(I),{class:"h-4 w-4"}),t[5]||(t[5]=V(" Add User ",-1))])])]),p.value?(o(),n("div",ee,[e("p",te,u(p.value),1)])):h("",!0),m.value?(o(),n("div",se,[e("p",ae,u(m.value),1)])):h("",!0),w.value?(o(),n("div",le,[g(b(L),{class:"h-8 w-8 text-gray-400 animate-spin"})])):(o(),n("div",ne,[e("table",oe,[t[8]||(t[8]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Username "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Role "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Created "),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",re,[(o(!0),n(B,null,S(y.value,s=>(o(),n("tr",{key:s.id},[e("td",ie,[e("span",de,u(s.username),1)]),e("td",ue,[e("span",{class:j(["px-2 py-1 text-xs font-medium rounded-full",{"bg-purple-100 text-purple-800":s.role==="admin","bg-blue-100 text-blue-800":s.role==="read-write","bg-gray-100 text-gray-800":s.role==="read-only"}])},u(s.role),3)]),e("td",ce,u(T(s.created_at)),1),e("td",ve,[e("button",{onClick:r=>q(s),class:"text-primary-600 hover:text-primary-900 mr-3"},[g(b(H),{class:"h-4 w-4"})],8,pe),e("button",{onClick:r=>E(s),class:"text-red-600 hover:text-red-900"},[g(b(G),{class:"h-4 w-4"})],8,me)])]))),128)),y.value.length===0?(o(),n("tr",fe,[...t[7]||(t[7]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," No users found ",-1)])])):h("",!0)])])])),_.value?(o(),n("div",xe,[e("div",ye,[e("div",ge,[e("h3",be,u(c.value==="create"?"Create User":"Edit User"),1),e("button",{onClick:D,class:"text-gray-400 hover:text-gray-600"},[g(b(J),{class:"h-5 w-5"})])]),e("form",{onSubmit:W(z,["prevent"]),class:"space-y-4"},[e("div",null,[t[9]||(t[9]=e("label",{class:"label"},"Username",-1)),$(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.username=s),type:"text",required:"",disabled:c.value==="edit",class:j(["input",{"bg-gray-100":c.value==="edit"}])},null,10,we),[[A,l.value.username]])]),e("div",null,[e("label",he,u(c.value==="create"?"Password":"New Password (leave empty to keep current)"),1),$(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.password=s),type:"password",required:c.value==="create",class:"input"},null,8,_e),[[A,l.value.password]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"label"},"Role",-1)),$(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.role=s),class:"input"},[(o(),n(B,null,S(N,s=>e("option",{key:s.value,value:s.value},u(s.label),9,ke)),64))],512),[[Z,l.value.role]])]),e("div",Ce,[e("button",{type:"button",onClick:D,class:"btn btn-secondary"}," Cancel "),e("button",{type:"submit",disabled:v.value,class:"btn btn-primary"},u(v.value?"Saving...":c.value==="create"?"Create":"Save"),9,Ue)])],32)])])):h("",!0),k.value?(o(),n("div",Me,[e("div",De,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Delete User?",-1)),e("p",je,' Are you sure you want to delete user "'+u((i=x.value)==null?void 0:i.username)+'"? This action cannot be undone. ',1),e("div",$e,[e("button",{onClick:t[3]||(t[3]=s=>{k.value=!1,x.value=null}),class:"btn btn-secondary"}," Cancel "),e("button",{onClick:F,disabled:v.value,class:"btn btn-danger"},u(v.value?"Deleting...":"Delete"),9,Ve)])])])):h("",!0)])}}});export{Le as default};
